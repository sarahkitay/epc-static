"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const A=require("react"),l=require("../../contexts/afterpay/afterpay.cjs.js"),m=require("../../hooks/use-event-listener.cjs.js"),E=require("../../contexts/form/form.cjs.js"),v=require("./afterpay.styles.cjs.js");function M(e){if(e&&e.__esModule)return e;const r=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const s in e)if(s!=="default"){const c=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(r,s,c.get?c:{enumerable:!0,get:()=>e[s]})}}return r.default=e,Object.freeze(r)}const t=M(A);function w({Button:e,buttonColor:r="black",buttonType:s="buy_now_with_afterpay",finalCtaButtonType:c="buy_now",id:a="rswps-afterpay-button",...f}){const i=t.useRef(null),o=l.useAfterpay(),{cardTokenizeResponseReceived:u}=E.useForm(),p=t.useMemo(()=>({buttonColor:r,buttonType:s,finalCtaButtonType:c,useCustomButton:Boolean(e)}),[e,r,s,c]),g=async y=>{if(y.stopPropagation(),!o){console.warn("Afterpay/Clearpay button was clicked, but no Afterpay/Clearpay instance was found.");return}try{const n=await o.tokenize();if(n.status==="OK")return u(n);let d=`Tokenization failed with status: ${n?.status}`;if(n&&"errors"in n)throw d+=` and errors: ${JSON.stringify(n?.errors)}`,new Error(d);console.warn(d)}catch(n){console.error(n)}};return t.useEffect(()=>(o&&o?.attach(`#${a}`,p),()=>{o&&o?.destroy()}),[o]),m.useEventListener({listener:g,type:"click",element:i,options:{passive:!0}}),e?t.createElement(e,{...f,id:a,ref:i}):t.createElement("div",{...f,id:a,ref:i},o?null:t.createElement(v.ButtonLoader,null))}function j({badgeTheme:e="black-on-mint",component:r,id:s="rswps-afterpay-message",modalLinkStyle:c="circled-info-icon",modalTheme:a="mint",size:f="md",...i}){const o=t.useRef(null),u=l.useAfterpay(),p=t.useMemo(()=>({badgeTheme:e,modalLinkStyle:c,modalTheme:a,size:f}),[e,c,a,f]);t.useEffect(()=>{const n=async()=>{await u?.attachMessaging(`#${s}`,p)};u&&!r?.Message&&n()},[u,r?.Message,p]);const g=async n=>{n.stopPropagation(),u?.displayInformationModal({modalTheme:a})};m.useEventListener({listener:g,type:"click",element:o,options:{passive:!0}});const y=r?.Message;return y?t.createElement(y,{...i,id:s,ref:o}):t.createElement("div",{...i,id:s})}function b({includeBranding:e,id:r="rswps-afterpay-widget",...s}){const c=t.useRef(null),a=l.useAfterpay();return t.useEffect(()=>{a&&(async()=>{await a?.attachCheckoutWidget(`#${r}`,{includeBranding:e})})()},[a,e]),t.createElement("div",{...s,id:r,ref:c})}function _(e){return t.createElement(l.default,null,t.createElement(w,{...e}))}exports.AfterpayContext=l.AfterpayContext;exports.AfterpayProvider=l.default;exports.AfterpayButton=w;exports.AfterpayMessage=j;exports.AfterpayWidget=b;exports.default=_;
//# sourceMappingURL=afterpay.cjs.js.map
